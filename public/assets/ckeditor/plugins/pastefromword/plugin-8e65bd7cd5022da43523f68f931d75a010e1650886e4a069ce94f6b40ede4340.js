!function(){function e(e,t,n){var i=CKEDITOR.cleanWord;return i?n():(e=CKEDITOR.getUrl(e.config.pasteFromWordCleanupFile||t+"filter/default.js"),CKEDITOR.scriptLoader.load(e,n,null,!0)),!i}function t(e){e.data.type="html"}CKEDITOR.plugins.add("pastefromword",{requires:"clipboard",lang:"en",icons:"pastefromword,pastefromword-rtl",hidpi:!0,init:function(n){var i=0,a=this.path;n.addCommand("pastefromword",{canUndo:!1,async:!0,exec:function(e){var n=this;i=1,e.once("beforePaste",t),e.getClipboardData({title:e.lang.pastefromword.title},function(t){t&&e.fire("paste",{type:"html",dataValue:t.dataValue,method:"paste",dataTransfer:CKEDITOR.plugins.clipboard.initPasteDataTransfer()}),e.fire("afterCommandExec",{name:"pastefromword",command:n,returnValue:!!t})})}}),n.ui.addButton&&n.ui.addButton("PasteFromWord",{label:n.lang.pastefromword.toolbar,command:"pastefromword",toolbar:"clipboard,50"}),n.on("pasteState",function(e){n.getCommand("pastefromword").setState(e.data)}),n.on("paste",function(t){var o=t.data,r=o.dataValue;if(r&&(i||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(r))){o.dontFilter=!0;var s=e(n,a,function(){s?n.fire("paste",o):(!n.config.pasteFromWordPromptCleanup||i||confirm(n.lang.pastefromword.confirmCleanup))&&(o.dataValue=CKEDITOR.cleanWord(r,n)),i=0});s&&t.cancel()}},null,null,3)}})}();