!function(){function e(e){return CKEDITOR.env.ie?e.$.clientWidth:parseInt(e.getComputedStyle("width"),10)}function t(e,t){var n=e.getComputedStyle("border-"+t+"-width"),a={thin:"0px",medium:"1px",thick:"2px"};return 0>n.indexOf("px")&&(n=n in a&&"none"!=e.getComputedStyle("border-style")?a[n]:0),parseInt(n,10)}function n(e){var n,a=[],i=-1,r="rtl"==e.getComputedStyle("direction");n=e.$.rows;for(var o,s,l,c=0,u=0,d=n.length;u<d;u++)l=n[u],o=l.cells.length,o>c&&(c=o,s=l);for(n=s,c=new CKEDITOR.dom.element(e.$.tBodies[0]),o=c.getDocumentPosition(),s=0,l=n.cells.length;s<l;s++){var h,m,u=new CKEDITOR.dom.element(n.cells[s]),d=n.cells[s+1]&&new CKEDITOR.dom.element(n.cells[s+1]),i=i+(u.$.colSpan||1),p=u.getDocumentPosition().x;r?m=p+t(u,"left"):h=p+u.$.offsetWidth-t(u,"right"),d?(p=d.getDocumentPosition().x,r?h=p+d.$.offsetWidth-t(d,"right"):m=p+t(d,"left")):(p=e.getDocumentPosition().x,r?h=p:m=p+e.$.offsetWidth),u=Math.max(m-h,3),a.push({table:e,index:i,x:h,y:o.y,width:u,height:c.$.offsetHeight,rtl:r})}return a}function a(e){(e.data||e).preventDefault()}function i(n){function i(){p=0,m.setOpacity(0),g&&r();var e=d.table;setTimeout(function(){e.removeCustomData("_cke_table_pillars")},0),h.removeListener("dragstart",a)}function r(){for(var a=d.rtl,i=a?E.length:v.length,r=0,s=0;s<i;s++){var l=v[s],c=E[s],u=d.table;CKEDITOR.tools.setTimeout(function(e,t,s,l,c,d){e&&e.setStyle("width",o(Math.max(t+d,1))),s&&s.setStyle("width",o(Math.max(l-d,1))),c&&u.setStyle("width",o(c+d*(a?-1:1))),++r==i&&n.fire("saveSnapshot")},0,this,[l,l&&e(l),c,c&&e(c),(!l||!c)&&e(u)+t(u,"left")+t(u,"right"),g])}}function l(t){a(t),n.fire("saveSnapshot"),t=d.index;for(var i=CKEDITOR.tools.buildTableMap(d.table),r=[],o=[],s=Number.MAX_VALUE,l=s,T=d.rtl,k=0,C=i.length;k<C;k++){var I=i[k],R=I[t+(T?1:0)],I=I[t+(T?0:1)],R=R&&new CKEDITOR.dom.element(R),I=I&&new CKEDITOR.dom.element(I);R&&I&&R.equals(I)||(R&&(s=Math.min(s,e(R))),I&&(l=Math.min(l,e(I))),r.push(R),o.push(I))}v=r,E=o,b=d.x-s,y=d.x+l,m.setOpacity(.5),f=parseInt(m.getStyle("left"),10),g=0,p=1,m.on("mousemove",u),h.on("dragstart",a),h.on("mouseup",c,this)}function c(e){e.removeListener(),i()}function u(e){T(e.data.getPageOffset().x)}var d,h,m,p,f,g,v,E,b,y;h=n.document,m=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"></div>',h),n.on("destroy",function(){m.remove()}),s||h.getDocumentElement().append(m),this.attachTo=function(e){p||(s&&(h.getBody().append(m),g=0),d=e,m.setStyles({width:o(e.width),height:o(e.height),left:o(e.x),top:o(e.y)}),s&&m.setOpacity(.25),m.on("mousedown",l,this),h.getBody().setStyle("cursor","col-resize"),m.show())};var T=this.move=function(e){if(!d)return 0;if(!p&&(e<d.x||e>d.x+d.width))return d=null,p=g=0,h.removeListener("mouseup",c),m.removeListener("mousedown",l),m.removeListener("mousemove",u),h.getBody().setStyle("cursor","auto"),s?m.remove():m.hide(),0;if(e-=Math.round(m.$.offsetWidth/2),p){if(e==b||e==y)return 1;e=Math.max(e,b),e=Math.min(e,y),g=e-f}return m.setStyle("left",o(e)),1}}function r(e){var t=e.data.getTarget();if("mouseout"==e.name){if(!t.is("table"))return;for(var n=new CKEDITOR.dom.element(e.data.$.relatedTarget||e.data.$.toElement);n&&n.$&&!n.equals(t)&&!n.is("body");)n=n.getParent();if(!n||n.equals(t))return}t.getAscendant("table",1).removeCustomData("_cke_table_pillars"),e.removeListener()}var o=CKEDITOR.tools.cssLength,s=CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks);CKEDITOR.plugins.add("tableresize",{requires:"tabletools",init:function(e){e.on("contentDom",function(){var t,o=e.editable();o.attachListener(o.isInline()?o:e.document,"mousemove",function(o){o=o.data;var s=o.getTarget();if(s.type==CKEDITOR.NODE_ELEMENT){var l=o.getPageOffset().x;if(t&&t.move(l))a(o);else if((s.is("table")||s.getAscendant("tbody",1))&&(s=s.getAscendant("table",1),e.editable().contains(s))){(o=s.getCustomData("_cke_table_pillars"))||(s.setCustomData("_cke_table_pillars",o=n(s)),s.on("mouseout",r),s.on("mousedown",r));e:{for(var s=0,c=o.length;s<c;s++){var u=o[s];if(l>=u.x&&l<=u.x+u.width){l=u;break e}}l=null}l&&(!t&&(t=new i(e)),t.attachTo(l))}}})})}})}();