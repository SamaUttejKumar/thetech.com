CKEDITOR.plugins.add("iframedialog",{requires:"dialog",onLoad:function(){CKEDITOR.dialog.addIframe=function(e,t,n,a,o,i,r){n={type:"iframe",src:n,width:"100%",height:"100%"},n.onContentLoad="function"==typeof i?i:function(){var e=this.getElement().$.contentWindow;if(e.onDialogEvent){var t=this.getDialog(),n=function(t){return e.onDialogEvent(t)};t.on("ok",n),t.on("cancel",n),t.on("resize",n),t.on("hide",function(e){t.removeListener("ok",n),t.removeListener("cancel",n),t.removeListener("resize",n),e.removeListener()}),e.onDialogEvent({name:"load",sender:this,editor:t._.editor})}};var s,l={title:t,minWidth:a,minHeight:o,contents:[{id:"iframe",label:t,expand:!0,elements:[n],style:"width:"+n.width+";height:"+n.height}]};for(s in r)l[s]=r[s];this.add(e,function(){return l})},function(){var e=function(e,t,n){if(!(3>arguments.length)){var a=this._||(this._={}),o=t.onContentLoad&&CKEDITOR.tools.bind(t.onContentLoad,this),i=CKEDITOR.tools.cssLength(t.width),r=CKEDITOR.tools.cssLength(t.height);a.frameId=CKEDITOR.tools.getNextId()+"_iframe",e.on("load",function(){CKEDITOR.document.getById(a.frameId).getParent().setStyles({width:i,height:r})});var s={src:"%2",id:a.frameId,frameborder:0,allowtransparency:!0},l=[];"function"==typeof t.onContentLoad&&(s.onload="CKEDITOR.tools.callFunction(%1);"),CKEDITOR.ui.dialog.uiElement.call(this,e,t,l,"iframe",{width:i,height:r},s,""),n.push('<div style="width:'+i+";height:"+r+';" id="'+this.domId+'"></div>'),l=l.join(""),e.on("show",function(){var e=CKEDITOR.document.getById(a.frameId).getParent(),n=CKEDITOR.tools.addFunction(o),n=l.replace("%1",n).replace("%2",CKEDITOR.tools.htmlEncode(t.src));e.setHtml(n)})}};e.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.dialog.addUIElement("iframe",{build:function(t,n,a){return new e(t,n,a)}})}()}});