!function(){function e(e,n,a){if(!e.getCustomData("indent_processed")){var i=this.editor,o=this.isIndent;if(n){if(i=e.$.className.match(this.classNameRegex),a=0,i&&(i=i[1],a=CKEDITOR.tools.indexOf(n,i)+1),0>(a+=o?1:-1))return;a=Math.min(a,n.length),a=Math.max(a,0),e.$.className=CKEDITOR.tools.ltrim(e.$.className.replace(this.classNameRegex,"")),0<a&&e.addClass(n[a-1])}else{n=t(e,a),a=parseInt(e.getStyle(n),10);var r=i.config.indentOffset||40;if(isNaN(a)&&(a=0),a+=(o?1:-1)*r,0>a)return;a=Math.max(a,0),a=Math.ceil(a/r)*r,e.setStyle(n,a?a+(i.config.indentUnit||"px"):""),""===e.getAttribute("style")&&e.removeAttribute("style")}CKEDITOR.dom.element.setMarker(this.database,e,"indent_processed",1)}}function t(e,t){return"ltr"==(t||e.getComputedStyle("direction"))?"margin-left":"margin-right"}var n=CKEDITOR.dtd.$listItem,a=CKEDITOR.dtd.$list,i=CKEDITOR.TRISTATE_DISABLED,o=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentblock",{requires:"indent",init:function(r){function s(){l.specificDefinition.apply(this,arguments),this.allowedContent={"div h1 h2 h3 h4 h5 h6 ol p pre ul":{propertiesOnly:!0,styles:c?null:"margin-left,margin-right",classes:c||null}},this.enterBr&&(this.allowedContent.div=!0),this.requiredContent=(this.enterBr?"div":"p")+(c?"("+c.join(",")+")":"{margin-left}"),this.jobs={20:{refresh:function(e,a){var r=a.block||a.blockLimit;if(!r.is(n))var s=r.getAscendant(n),r=s&&a.contains(s)||r;if(r.is(n)&&(r=r.getParent()),this.enterBr||this.getContext(a)){if(c){var s=c,r=r.$.className.match(this.classNameRegex),l=this.isIndent,s=r?!l||r[1]!=s.slice(-1):l;return s?o:i}return this.isIndent?o:r?CKEDITOR[0>=(parseInt(r.getStyle(t(r)),10)||0)?"TRISTATE_DISABLED":"TRISTATE_OFF"]:i}return i},exec:function(t){var n,i=t.getSelection(),i=i&&i.getRanges()[0];if(n=t.elementPath().contains(a))e.call(this,n,c);else for(i=i.createIterator(),t=t.config.enterMode,i.enforceRealBlocks=!0,i.enlargeBr=t!=CKEDITOR.ENTER_BR;n=i.getNextParagraph(t==CKEDITOR.ENTER_P?"p":"div");)n.isReadOnly()||e.call(this,n,c);return!0}}}}var l=CKEDITOR.plugins.indent,c=r.config.indentClasses;l.registerCommands(r,{indentblock:new s(r,"indentblock",!0),outdentblock:new s(r,"outdentblock")}),CKEDITOR.tools.extend(s.prototype,l.specificDefinition.prototype,{context:{div:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,p:1,pre:1,table:1},classNameRegex:c?new RegExp("(?:^|\\s+)("+c.join("|")+")(?=$|\\s)"):null})}})}();