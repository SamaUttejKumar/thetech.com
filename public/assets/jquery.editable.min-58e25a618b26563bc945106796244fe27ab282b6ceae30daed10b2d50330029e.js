!function(e){var t=function(e){return e.replace(/</gm,"&lt;").replace(/>/gm,"&gt;")};e.fn.editable=function(n,i){if("function"!=typeof i&&(i=function(){}),"string"==typeof n)var o=this,r=n,a="input";else{if("object"!=typeof n)throw'Argument Error - jQuery.editable("click", function(){ ~~ })';var o=n.trigger||this;"string"==typeof o&&(o=e(o));var r=n.action||"click",a=n.type||"input"}var s=this,l={};return l.start=function(){o.unbind("clickhold"===r?"mousedown":r),o!==s&&o.hide();var n=("textarea"===a?s.text().replace(/<br( \/)?>/gm,"\n").replace(/&gt;/gm,">").replace(/&lt;/gm,"<"):s.text()).replace(/^\s+/,"").replace(/\s+$/,""),c=e("textarea"===a?"<textarea>":"<input>");c.val(n).css("width","textarea"===a?"100%":s.width()+s.height()).css("font-size","100%").css("margin",0).attr("id","editable_"+1*new Date).addClass("editable"),"textarea"===a&&c.css("height",s.height());var d=function(){var e=c.val().replace(/^\s+/,"").replace(/\s+$/,""),r=t(e);"textarea"===a&&(r=r.replace(/[\r\n]/gm,"<br />")),s.html(r),i({value:e,target:s,old_value:n}),l.register(),o!==s&&o.show()};c.blur(d),"input"===a&&c.keydown(function(e){13===e.keyCode&&d()}),s.html(c),c.focus()},l.register=function(){if("clickhold"===r){var e=null;o.bind("mousedown",function(t){e=setTimeout(function(){l.start(t)},500)}),o.bind("mouseup mouseout",function(){clearTimeout(e)})}else o.bind(r,l.start)},l.register(),this}}(jQuery);